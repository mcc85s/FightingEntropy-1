<#___ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____ -- ____  
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯   //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//         [ Secure Digits Plus LLC | "Fighting Entropy" ]          \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯       _____________________________________________________        ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯        __/¯¯\__[ Dynamically Engineered Digital Security ]__/¯¯\__         ¯¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  _________________________ ________________ ___________________________________  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__// | Application Development | Virtualization | Network and Hardware Magistration | \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\  ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯  //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//                        https://www.securedigitsplus.com                          \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___                     ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯                       ___//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\   [ Provisional Author : Michael C Cook Sr. | "The Buck Stops Here" ]    //¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__// 
//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//   ____    ____    ____    ____    ____    ____    ____    ____    ____   \\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\ 
\\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__/====\__/----\__// 
//¯¯    
\\  [ FightingEntropy ] @: A module meant to kick the crap out of entropy, AND identity theft. Like a ninja. Might sound intense..? Cause it is.
//   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____      
\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\___  
//¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯\\ #>

# Load Classes
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____    ____    ____    ____    ____    ____    ___// 
    # Module ___________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

    Class FEModule # // Module Path Definitions
    {
        [String] $Name               = "FightingEntropy"
        [String] $Version            = "2020.08.0"
        [String] $Provider           = "Secure Digits Plus LLC"
        [String] $Registry           = "HKLM:\SOFTWARE\Policies\{0}\{1}\{2}"
        [String] $Path               = "$Env:ProgramData\{0}\{1}\{2}"
        [Object] $Content

        Hidden [String[]] $Folders   = "Control","Graphics","Network"
        Hidden [String[]] $Files     = "FightingEntropy.ps1","FightingEntropy.psm1"

        FEModule()
        {
            $This.Registry           = $This.Registry -f $This.Provider, $This.Name, $This.Version
            $This.Path               = $This.Path     -f $This.Provider, $This.Name, $This.Version
        
            If ( ! ( Test-Path $This.Registry ) )
            {
                ForEach ( $I in 3..5 ) 
                { 
                    $This.Registry.Split('\')[0..$I] -join '\' | ? { ! ( Test-Path $_ ) } | % { New-Item $_ -Verbose }
                }
            }

            If ( ! ( Test-Path $This.Path ) )
            {
                New-Item -Path $This.Path -ItemType Directory -Verbose
            }

            $This.Folders            | % { "{0}\$_" -f $This.Path } | ? { ! ( Test-Path $_ ) } | % { New-Item -Path $_ -ItemType Directory -Verbose }

            $This.Content            = Get-ChildItem $This.Path
        }
    }

    Class FERoot
    {
        [String] $Name
        [String] $Date
        [String] $Path
        [Object] $Share

        FERoot([String]$Name,[String]$Path)
        {
            $This.Name = $Name
            $This.Date = Get-Date -UFormat "%Y_%m%d-%H%M%S"
            $This.Path = $Path

            "Name Date Path Share".Split(" ") | % { Set-ItemProperty -Path $This.Root -Name $_ -Value $This.$_ -Verbose }
        }
    }

    Class FEShare
    {
        [String]           $Name = "FE001"
        [String]     $PSProvider
        [String]           $Root
        [String]    $Description = $Null
        [String]    $NetworkPath
        [Object]        $Company = [FECompany]::New()

        Hidden [String[]] $Names
        Hidden [String[]] $Roots

        Hidden [Hashtable] $Hash = @{

            Name        = "Microsoft Deployment Toolkit" 
            Path        = ( GCI ( GP "HKLM:\Software\Microsoft\Deployment 4" ).Install_Dir "*Toolkit.psd1" -Recurse ).FullName
            Description = ("The [Microsoft Deployment Toolkit]\\_It is *the* toolkit...\_...that Microsoft themselves uses...\" +
                            "_...to deploy additional toolkits.\\_It's not that weird.\_You're just thinking way too far into it" +
                            ", honestly.\\_Regardless... it is quite a fearsome toolkit to have in one's pocket.\_Or, wherever " +
                            "really...\_...at any given time.\\_When you need to be taken seriously...?\_Well, it *should* be t" +
                            "he first choice on one's agenda.\_But that's up to you.\\_The [Microsoft Deployment Toolkit].\_Eve" +
                            "n Mr. Gates thinks it's awesome." ).Replace("_","    ").Split('\')
        }

        FEShare([String]$Name,[String]$Root,[String]$Description,[String]$NetworkPath)
        {
            If ( Test-Path $Root )
            {
                Throw "Path exists"
            }

            Else
            {
                $This.Root = $Root
            }

            If ( Get-SMBShare | ? { $_.Name -eq $Name -or $_.Path -eq $Root } )
            {
                Throw "Share exists"
            }

            @{  Name        = "Microsoft Deployment Toolkit" 
                Path        = ( GCI ( GP "HKLM:\Software\Microsoft\Deployment 4" ).Install_Dir "*Toolkit.psd1" -Recurse ).FullName
                Description = ("The [Microsoft Deployment Toolkit]\\_It is *the* toolkit...\_...that Microsoft themselves uses...\" +
                               "_...to deploy additional toolkits.\\_It's not that weird.\_You're just thinking way too far into it" +
                               ", honestly.\\_Regardless... it is quite a fearsome toolkit to have in one's pocket.\_Or, wherever " +
                               "really...\_...at any given time.\\_When you need to be taken seriously...?\_Well, it *should* be t" +
                               "he first choice on one's agenda.\_But that's up to you.\\_The [Microsoft Deployment Toolkit].\_Eve" +
                               "n Mr. Gates thinks it's awesome." ).Replace("_","    ").Split('\') } | % {

                If ( $_.Path -eq $Null )
                {
                    Throw ( "{0} is not installed" -f $_.Names )
                }

                Import-Module $_.Path -Verbose

                Write-Theme $_.Description
            }

            $This.Names        = ( Get-MDTPersistentDrive ).Name
            $This.Roots        = ( Get-MDTPersistentDrive ).Path

            If ( $Name -in $This.Names -or $Root -in $This.Roots )
            {
                Throw "MDT/FE Share exists"
            }

            If ( $This.Names -ne $Null )
            {
                $This.Name     = $This.Names | % { @($_,$_[-1])[[Int32]($_.Count -gt 1)].Replace("DS","") } | % { "FE{0:d3}" -f ( [Int32]$_ + 1 ) }
            }

            $This.PSProvider   = "MDTProvider" 
            $This.Root         = $Root
            $This.Description  = If ( $Description -ne $Null ) { $Description }
            $This.NetworkPath  = $NetworkPath

            @{  
                Path           = $Root
                ItemType       = "Directory"      
            
            }                  | % { New-Item @_ -Verbose }

            @{  
                Name           = $Name
                Path           = $Root 
                FullAccess     = "Administrators" 
            
            }                  | % { New-SMBShare @_ -Verbose }

            @{  
                Name           = $This.Name 
                PSProvider     = $This.PSProvider
                Root           = $This.Root
                Description    = $This.Description
                NetworkPath    = $This.NetworkPath
                Verbose        = $True  

            } | % { New-PSDrive @_ | add-MDTPersistentDrive -Verbose }
        }
    }

    Class FECompany
    {
        [String] $Name
        [String] $Branch
        [String] $Background
        [String] $Logo
        [String] $Phone
        [String] $Website
        [String] $Hours

        FECompany() {}

        Load([String]$Name,[String]$Branch,[String]$Background,[String]$Logo,[String]$Phone,[String]$Website,[String]$Hours)
        { 
            $This.Name       = $Name
            $This.Branch     = $Branch
            $This.Background = $Background
            $This.Logo       = $Logo
            $This.Phone      = $Phone
            $This.Website    = $Website
            $This.Hours      = $Hours
        }
    }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____    ____    ____    ____    ____    ____    ___// 
    # Theme ____________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

    Class FEBlock 
    {
        [Int32]            $Index
        [String]          $Object
        [Int32]  $ForegroundColor
        [Int32]  $BackgroundColor

        FEBlock([Int32]$Index,[String]$Object,[Int32]$ForegroundColor,[Int32]$BackgroundColor)
        {
            $This.Index             = $Index
            $This.Object            = $Object
            $This.ForegroundColor   = $ForegroundColor
            $This.BackgroundColor   = $BackgroundColor
        }
    }

    Class FETrack
    {
        [Int32]           $Index
        [Array]           $Object

        Hidden [String]   $Header
        Hidden [Array]    $Body
        Hidden [String]   $Footer

        Hidden [String[]] $Strings
        Hidden [Int32[]]  $Masks
        Hidden [Int32[]]  $Foregrounds
        Hidden [Int32[]]  $Backgrounds

        Hidden [String]   $String
        Hidden [Int32]    $Segments
        Hidden [Object]   $Track
        Hidden [Array]    $Swap

        FETrack(){}
         
        FETrack([Int32]$Index,[String]$Mask,[String]$Foreground,[String]$Background)
        {
            $This.Index                = $Index
            $This.Masks                = Invoke-Expression $Mask
            $This.Strings              = @("    ,____,¯¯¯¯,----,   /,\   ,   \,/   ,\__/,/¯¯\,/¯¯¯,¯¯¯\,\___,___/,[ __,__ ]" -Split ",")[$This.Masks]
            $This.Foregrounds          = Invoke-Expression $Foreground
            $This.Backgrounds          = Invoke-Expression $Background
             
            $This.Object               = @( )

            ForEach ( $I in 0..( $This.Masks.Count - 1 ) )
            {
                $This.Object          += [FEBlock]::New($I,$This.Strings[$I],$This.Foregrounds[$I],$This.Backgrounds[$I])
            }
        }

        Load([String]$String)
        {
            If ( !$String ) 
            { 
                Throw "String/Track is null" 
            }

            $This.String = $String

            If ( $String.Length % 4 -ne 0 )
            {
                $This.String           = "[ $String{0} ]" -f ( " " * ( 4 - ( $String.Length % 4 ) ) )
            }

            $This.Segments             = $This.String.Length / 4
             
            If ( $This.Segments -gt 23 ) 
            { 
                Throw "Input string too long" 
            } 

            $This.Object[3..25]        | % { $_.Object = "    " ; $_.ForegroundColor = 0 }
            $This.Swap                 = @( )
             
            ForEach ( $I in 0..( $This.Segments - 1 ) )
            {     
                $This.Swap            += [FEBlock]::New( $I,($This.String[($I*4)..(($I*4)+3)] -join '' ), 2, 0) 
            }

            ForEach ( $Z in 0..( $This.Swap.Count -  1 ) )
            {
                $This.Swap[$Z]         | % { $_.Index = $_.Index + 3 }
                $This.Object[$Z+3]     = $This.Swap[$Z]
            }
        }
    }

    Class FEMask
    {
        [Int32]     $Index
        [Int32]     $Span
        [String]    $Mask
        [String]    $Foreground
        [String]    $Background

        FEMask([Int32]$Index,[Int32]$Span,[String]$Mask,[String]$Foreground,[String]$Background)
        {
            $This.Index                = $Index
            $This.Span                 = $Span
            $This.Mask                 = $Mask
            $This.Foreground           = $Foreground
            $This.Background           = $Background
        }
    }

    Class FEStock
    {
        Hidden [Object]  $Object
        [String]           $Name
        [Int32]            $Slot

        Hidden [Int32]     $Head
        Hidden [Int32]     $Main
        Hidden [Int32]     $Foot

        [String]         $Header
        [Array]            $Body
        [String]         $Footer

        Hidden [String[]] $Names  = @("Function","Action","Section","Table","Test")
        Hidden [Array]    $Theme 

        Hidden [Int32[]]   $Span 
        [Int32]          $Height 

        Hidden [Hashtable] $Hash  = @{
             
            Head                  =  3, 2, 3, 3, 3
            Main                  = -1,-1, 6,-1,-1
            Foot                  = -1,-1,11,-1,-1
            Colors                = $Palette

            Faces                 = "    ,____,¯¯¯¯,----,   /,\   ,   \,/   ,\__/,/¯¯\,/¯¯¯,¯¯¯\,\___,___/,[ __,__ ]".Split(",")

            String                = ("0;1;@(0)*25;1;1;0!4;9;12;@(1)*23;13;9;8;7!6;8;10;@(2)*23;11;8;10;0!0;11;12;14;@(1)*21;15;13;10;0;0!0;0;@(2)*25;0;0;0"+
                                    "!0;1;0;@(1)*25;0;0!4;9;8;10;@(2)*23;11;12;0!6;8;10;14;@(1)*21;15;0;13;9;5!0;11;12;@(1)*23;13;9;8;7!0;0;@(2)*25;0;2;0!"+
                                    "6;8;10;@(2)*23;11;8;9;5!4;9;12;14;@(1)*21;15;13;9;8;7!6;8;10;@(2)*24;0;11;5!4;10;@(0)*26;4;7!6;5;@(0)*26;6;5!4;7;@(0)"+
                                    "*26;13;7!6;12;@(0)*25;13;9;5!4;9;12;@(1)*23;13;10;13;7").Split("!") | % { "@($_)" } 

            Fore                  = ("@(0)*30!0;1;@(0)*25;1;1;0!0;1;@(1)*25;1;0;0!0;0;1;@(2)*23;1;0;0;0!@(0)*30!@(0)*30!0;1;0;@(1)*25;0;0!0;1;1;@(2)*23;1;"+
                                    "1;1;0!0;0;@(1)*25;0;1;0!@(0)*30!0;@(1)*28;0!0;1;1;@(2)*23;1;0;1;0!0;1;@(0)*26;0;0!@(0)*30!@(0)*30!@(0)*30!@(0)*28;1;0"+
                                    "!0;1;@(0)*25;1;1;0").Split("!") | % { "@($_)" } 

            Back                   = 0..17 | % { "@({0})" -f ( @(0)*30 -join ',' ) }
            Span                   = @{ 0 = 0..4; 1 = 5..9; 2 = @( 0..1;10..17;2..4 ); 3 = $Null; 4 = $Null }
        }

        [Hashtable]         $Process
        [Hashtable]          $Output      

        FEStock([Object]$Object)
        {
            $This.Object          = $Object
            If ( !$This.Object )  { Throw "Object is null" }

            $This.Slot            = If ( $This.Object.Count -eq 1 ) { If ( $This.Object -match "\[\:\]" ) {0} Else {1}} Else {2}
            $This.Name            = $This.Names[$This.Slot]

            $This.Hash            | % { 

                $This.Head        = $_.Head[$This.Slot]
                $This.Main        = $_.Main[$This.Slot]
                $This.Foot        = $_.Foot[$This.Slot]
                $This.Span        = $_.Span[$This.Slot]
            }

            $This.Body            = @(
                 
                If ( $This.Object.Count -gt 1 )
                {
                    ForEach ( $I in 0..( $This.Object.Count - 1 ) )
                    {
                        $Item = $This.Object[$I].GetType().Name

                        If ( $Item -eq "String" )
                        {
                            $This.Line($This.Object[$I])
                        }

                        Else
                        {
                            $This.Line( "-" * 84 )

                            If ( $Item -eq "Hashtable" ) 
                            {
                                $This.Object[$I].GetEnumerator() | Sort-Object Name | % { $This.Pair( $_.Name, $_.Value ) }
                            }
                            
                            Else
                            {
                                $Named = $This.Object[$I] | Get-Member | ? { $_.MemberType -eq "Property" } | % { $_.Name } 
                                
                                ForEach ( $N in $Named )
                                { 
                                    $This.Pair( $N, $This.Object[$I].$($N) ) 
                                }
                            }
                        }
                    }
                }

                If ( $This.Object.Count -eq 1 )
                {
                    $Item = $This.Object.GetType().Name
                    
                    If ( $Item -eq "String" )
                    {
                        $This.Line($This.Object)
                    }

                    Else
                    {
                        If ( $Item -eq "Hashtable" )
                        {
                            $This.Object.GetEnumerator() | Sort-Object Name | % { $This.Pair( $_.Name, $_.Value ) }
                        }

                        Else
                        {
                            $Named = $This.Object | Get-Member | ? { $_.MemberType -eq "Property" } | % { $_.Name } 
                            
                            ForEach ( $N in $Named )
                            { 
                                $This.Pair( $N, $This.Object.$($N) )
                            }
                        }
                    }
                }
            )

            $This.Theme           = @( )
            ForEach ( $I in 0..( $This.Span.Count - 1 ) )
            {
                $X                = $This.Span[$I]
                $This.Theme      += [FEMask]::New( $I , $X , $This.Hash.String[$X], $This.Hash.Fore[$X], $This.Hash.Back[$X] )
            }

            If ( $This.Slot -in 0,1 )
            {
                $This.Header      = $This.Body
                $This.Height      = 5
            }

            If ( $This.Slot -eq 2 )
            {
                $This.Header      = "Section"
                $This.Footer      = "Press Enter to Continue"
                $This.Height      = ( $This.Body.Count + $This.Span.Count ) - 1
            }

            $This.Process         = @{ }
            $Sort                 = $This.Head, $This.Main, $This.Foot
            $P                    = 0

            ForEach ( $I in 0..( $This.Theme.Count - 1 ) )
            {
                $Item = [FETrack]::New($I,$This.Theme[$I].Mask,$This.Theme[$I].Foreground,$This.Theme[$I].Background)

                If ( $I -eq $This.Head )
                {
                    $Item.Load($This.Header)
                    $This.Process.Add($P,$Item)
                    $P ++
                }

                If ( $I -eq $This.Foot )
                {
                    $Item.Load($This.Footer)
                    $This.Process.Add($P,$Item)
                    $P ++
                }

                If ( $I -eq $This.Main )
                {
                    ForEach ( $Z in 0..( $This.Body.Count - 1 ) )
                    {
                        $Item = [FETrack]::New($I,$This.Theme[$I].Mask,$This.Theme[$I].Foreground,$This.Theme[$I].Background)

                        ForEach ( $Q in 0,1,-2,-1)
                        {
                            $Item.Object[$Q] | % { $_.Object = $_.Object.Replace( @("/","\")[$Z % 2], @("\","/")[$Z % 2]) }
                        }

                        $Item.Load($This.Body[$Z])
                        $This.Process.Add($P,$Item)
                        $P ++
                    }

                    If ( $This.Body.Count -gt 1 -and $This.Body.Count % 2 -eq 0 )
                    {
                        $Item = [FETrack]::New($I,$This.Theme[$I].Mask,$This.Theme[$I].Foreground,$This.Theme[$I].Background)
                        $This.Process.Add($P,$Item)
                        $P ++
                    }
                }

                If ( $I -notin $Sort )
                {
                    $Item = [FETrack]::New($I,$This.Theme[$I].Mask,$This.Theme[$I].Foreground,$This.Theme[$I].Background)
                    $This.Process.Add($P,$Item)
                    $P ++
                }
            }
        }

        [String] Line([String]$Line)
        {
            Return @{          0  = "{0}{1}" -f    $Line, ( " " * (92 -  $Line.Length))
                               1  = "{0}..." -f (  $Line[0..88] -join '') }[[Int]($Line.Length -ge 89)]
        }
          
        [String] Pair([String]$Key,[String]$Value)
        {
            Return @{   0 = @{ 0  = "{0}{1}" -f    $Key,( " " * ( 25 -   $Key.Length ) ) 
                               1  = "{0}..." -f   ($Key[0..21] -join '')}[[Int]($Key.Length -ge 25)]
                        1 = @{ 0  = "{0}{1}" -f  $Value,( " " * ( 64 - $Value.Length ) )
                               1  = "{0}..." -f ($Value[0..60] -join '' ) }[[Int]($Value.Length -ge 64)] } | % { "{0} : {1}" -f $_[0,1] }
        }

        [Void] Draw([Object]$Object)
        {
            ForEach ( $I in 0..( $Object.Count - 1 ) )
            {
                $Track          = $Object[$I].Object
          
                ForEach ( $X in 0..( $Track.Count - 1 ) )
                { 
                    @{  
                        Object          = $Track[$X].Object
                        ForegroundColor = @($This.Hash.Colors)[$Track[$X].ForegroundColor]
                        BackgroundColor = $Track[$X].BackgroundColor
                        NoNewLine       = [Bool]( $X -ne ( $Track.Count - 1 ) )

                    }                   | % { Write-Host @_ }
                }
            }
        }
    }                                                                               #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____    ____    ____    ____    ____    ____    ___// 
    # Network __________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

    Class FEHost
    {
        [String]          $HostName
        [String]         $IPAddress
        [String]             $Class
        [String]        $MacAddress
        [String]            $Vendor

        FEHost([String]$IPAddress,[String]$MacAddress)
        {
            If ( $IPAddress -notmatch "(\d+).(\d+).(\d+).(\d+)" )
            {
                Throw "Invalid IPAddress"
            }

            If ( $MacAddress -notmatch "([A-Fa-f0-9]{2}(-|:)*){5}[A-Fa-f0-9]{2}" )
            {
                Throw "Invalid MacAddress"
            }

            $This.IPAddress         = $IPAddress
            $This.MacAddress        = $MacAddress
            $This.Class             = @('N/A';@('A')*126;'Local';@('B')*64;@('C')*32;@('MC')*16;@('R')*15;'BC')[$IPAddress.Split(".")[0]]

            If ( $This.Class -in "A","B","C" -and $This.MacAddress -notmatch "ff-ff-ff-ff-ff-ff" ) 
            {
                $This.Hostname      = Try { ( Resolve-DNSName $IPAddress -EA 0 ).NameHost } Catch { "*UnKnown*" }
                Write-Host "Resolved [+] $IPAddress..."
            }

            Else
            {
                $This.Hostname      = "-"
                Write-Host "Reserved [-] $IPAddress..."
            }
        }
    }

    Class FENetworkIPV4
    {
        [String] $Network
        [String] $Mask
        [String] $Start
        [String] $End
        [String] $Broadcast
        [String] $Range

        FENetworkIPV4([String]$Network,[String]$Mask,[String]$Start,[String]$End,[String]$Broadcast,[String]$Range)
        {
            $This.Network                        = $Network
            $This.Mask                           = $Mask
            $This.Start                          = $Start
            $This.End                            = $End
            $This.Broadcast                      = $Broadcast
            $This.Range                          = $Range
        }
    }

    Class FENetInterface
    {
        Hidden [Hashtable]    $Slot = @{ 0 = 1..7 ; 1 = 8..15 ; 2 = 16..23 ; 3 = 24..30 }
        Hidden [Array]        $Mask = 0..3
        Hidden [Int32]      $Switch = 0
        Hidden [Int32[]]      $Grid = @(0,128,192,224,240,248,252,254,255)

        [String]              $Type
        [String]           $ifAlias
        [Int32]            $ifIndex
        [String]         $IPAddress # 192.168.1.1
        [Int32]             $Prefix # 24
        [Object]           $Network
        #[String]           $Netmask # 255.255.255.0
        #[String]           $Network # 192.168.1.0
        #[String]         $Broadcast # 192.168.1.255
        #[String]           $Gateway # 192.168.1.1

        [String] GetV4NetMask([Int32]$Prefix)
        {
            If ( $Prefix -notin 1..30 )
            {
                Throw "CIDR out of range"
            }

            ForEach ( $I in 0..3 )
            {
                If ( $This.Switch -eq 1 ) 
                { 
                    $This.Mask[$I] = 0 
                }

                If ( $This.Switch -eq 0 )
                {
                    If ( $Prefix -in $This.Slot[$I] ) 
                    { 
                        $This.Mask[$I]   = $This.Grid[$Prefix % 8]
                        $This.Switch     = 1
                    } 
                
                    Else
                    { 
                        $This.Mask[$I]   = 255 
                    }
                }
            }
        
            Return $This.Mask[0..3] -join '.'
        }

        [FENetworkIPV4] GetV4Network([Int32]$Prefix)
        {
            $ID                      = @{  
                
                IPAddress            = ([IPAddress]$This.IPAddress).GetAddressBytes()
                Mask                 = ([IPAddress]$This.NetMask  ).GetAddressBytes()
                Class                = @('N/A';@('A')*126;'Local';@('B')*64;@('C')*32;@('MC')*16;@('R')*15;'BC')[$This.IPAddress.Split(".")[0]]
                Build                = 0..3
                Range                = 0..3
                Count                = @( )
                Collect              = @( )
                
            }

            If ( $ID.IPAddress[0] -in @( 0 , 127 ; 224..255 ) )
            {
                Throw "Invalid Address"
            }

            If ( ( $ID.IPAddress[0..1] -join '.' ) -eq "169.254" )
            {
                Throw "Invalid Address"
            }

                ForEach ( $I in 0..3 )
                {
                    $ID.Build[$I]                  = 256 - $ID.Mask[$I]

                    If ( $ID.Build[$I] -eq 1 )
                    {
                        $ID.Range[$I]              = $ID.IPAddress[$I]
                    }

                    If ( $ID.Build[$I] -in 2..255 )
                    {
                        $Z                         = $ID.Build[$I]

                        ForEach ( $Y in 0..( ( 256 / $Z ) - 1 ) )
                        { 
                            $X                     = $Z * $Y | % { $_..( $_ + ( $Z - 1 ) ) }

                            If ( $ID.IPAddress[$I] -in $X )
                            {
                                $ID.Range[$I]      = "$( $X[0] )..$( $X[$Z - 1] )"
                            }
                        }
                    }

                    If ( $ID.Build[$I] -eq    256 ) 
                    { 
                        $ID.Range[$I]              = "*" 
                    }
                }

                $ID.Count                          = Invoke-Expression ( $ID.Build -join "*" )
                $ID.Range                          = ( $ID.Range -join '/' ).Replace( "*" , "0..255" )

                ForEach ( $I in 3..0 )
                {
                    $Current                       = Invoke-Expression $ID.Range.Split('/')[$I]
                
                    If ( $ID.Collect.Count -eq 0 ) 
                    {
                        $Current                   | % { $ID.Collect += $_ }
                    }

                    Else
                    {
                        $Expand                    = $ID.Collect.Clone()

                        $ID.Collect                = @( )
                    
                        ForEach ( $J in $Current ) 
                        {
                            $Expand                | % { $ID.Collect += $J , $_ -join '.' }
                        }
                    }
                }

            Return [FENetworkIPV4]::New($ID.Collect[0],$ID.Mask.Replace(" ","."),$ID.Collect[1],$ID.Collect[-2],$ID.Collect[-1],$ID.Range)
        } 

        FENetInterface([CimInstance]$IPAddress)
        {
            $This.Type              = "IPV{0}" -f @(4,6)[[Int32]($IPAddress.IPAddress -notmatch "(\d+).(\d+).(\d+).(\d+)" )]
            $This.ifAlias           = $IPAddress.InterfaceAlias
            $This.ifIndex           = $IPAddress.InterfaceIndex
            $This.IPAddress         = $IPAddress.IPAddress
            $This.Prefix            = $IPAddress.PrefixLength

            $NetRoute               = Get-NetRoute -InterfaceIndex $This.ifIndex

            $This.Netmask           = $This.GetV4NetMask($This.Prefix)
            $This.Network           = ( $NetRoute | ? DestinationPrefix -match "/$($This.Prefix)" ).DestinationPrefix.Split("/")[0]
            $This.Broadcast         = 
            $This.Gateway           = $NetRoute | ? DestinationPrefix -match "0.0.0.0/0" | % { $_.NextHop }
        }
    }

    Class FENetAdapter
    {
        [String]             $Alias
        [String]             $Index
        [String]       $Description
        [String]          $HostName
        [String]            $Domain
        [Object]              $IPV4
        [Object]              $IPV6
        [String]        $MacAddress
        [String]            $Vendor
        [Object]             $Table

        [Object] Form([String]$Line)
        {
            $Item                   = $Line -Split " " | ? { $_.Length -gt 0 }

            Return ( [FEHost]::New( $Item[0], $Item[1] ) )
        }

        FENetAdapter([String[]]$Table)
        {

            $This.Index             = Invoke-Expression ( $Table[0] -Split " " )[3]

            $This.IPV4              = Get-NetIPAddress -AddressFamily IPv4 | ? ifIndex -eq $This.Index
            $This.IPV6              = Get-NetIPAddress -AddressFamily IPv6 | ? ifIndex -eq $This.Index

            $This.Table             = @( )
            
            If ( $Table.Count -gt 2 ) 
            {
                $Table[2..($Table.Count-1)] | % { 
                    
                    $This.Table    += $This.Form($_) 
                }
            }

            Else
            {
                $This.Table         = $This.Form($Table[2])
            }
        }
    }

    Class FEVendor
    {
        [String]               $Hex
        [Int32]              $Index
        [String]              $Name

        FEVendor([String]$MacAddress)
        {
            $This.Hex               = ( $MacAddress -Replace "(:|-)" , "" ).SubString(0,6)
            $This.Index             = [Convert]::ToInt64($This.Hex,16)
        }
    }

    Class FEVendorList
    {
        Hidden [String]       $Path
        [String[]]            $List
        [Int32[]]            $Index
        [String[]]            $Name

        FEVendorList([String]$Path)
        {
            $This.Path              = "$Path\Archives\Network"

            If ( ! ( Test-Path "$($This.Path)\Vendor.zip" ) )
            {
                Throw "Invalid Path"
            }

            Write-Host "Retrieving Vendor List"

            Expand-Archive -Path "$($This.Path)\Vendor.zip" -DestinationPath $This.Path -Force

            ForEach ( $Item in "Index","Name","List" )
            {
                $This.$Item         = "$($This.Path)\$Item.txt" | % { Get-Content $_ ; Remove-Item $_ }
                Write-Host "  Loaded [+] $Item"
            }
        }
    }

    Class FENetwork
    {
        Hidden [Hashtable]    $Hash = @{

            Class                   = @('N/A';@('A')*126;'Local';@('B')*64;@('C')*32;@('MC')*16;@('R')*15;'BC')

            NBTScan                 = @{

                ID                  = ("00,01,01,03,06,1F,20,21,22,23,24,30,31,43,44,45,46,4C,42,52,87,6A,BE,BF,03,00,1B,1C,1D,1E,2B,2F,33,20,01" -Split ",") | % { "<$_>" }
                Type                = ("UNIQUE,GROUP" -Split ',')[@(0,0,1;@(0)*22;@(1,0)*3;@(1)*4)]
                Service             = (("Workstation {0},{2} {0},{7} {8},{2} {0},RAS {10} {0},NetDDE {0},File {10} {0},RAS Client {0},{1} {9} Interchange" +
                                      "[MSMail Connector],{1} {9} Store,{1} {9} Directory,{4} {10},{4} Client,{5} Control,SMS Administrators Remote Cont" +
                                      "rol Tool {0},{5} Chat,{5} Transfer,DEC TCPIP {0} on Windows NT,McAfee Anti-Virus,DEC TCPIP {0} on Windows NT,{1} " +
                                      "{9} MTA,{1} {9} IMC,Network Monitor Agent,Network Monitor Application,{2} {0},{6} Name,{6} {7} {8},{6} Controller" + 
                                      ",{7} {8},{8} {0} Elections,{3} {10},{3},{3},DCA IrmaLan Gateway {10},MS NetBIOS Browse {0}") -f "Service","Microsoft",
                                      "Messenger","Lotus Notes","Modem Sharing","SMS Clients Remote","Domain","Master","Browser","Exchange","Server").Split(",")
            }

            NetMask                 = @{ 

                Slot                = @{ 0 = 1..7 ; 1 = 8..15 ; 2 = 16..23 ; 3 = 24..30 }
                Mask                = 0..3
                Switch              = 0
                Remain              = $Null
            }
        }

        [String]                       $Path
        [String]               $ComputerName
        [String]                     $Domain

        Hidden [Object]              $Vendor
        [Object]                  $Interface
        [Object]                  $HostRange

        [String] GetVendor([String]$MacAddress)
        {
            $IVendor                           = [FEVendor]::New($MacAddress)
            $Rank                              = 0

            ForEach ( $I in 1..( $This.Vendor.Index.Count ) )
            {
                If ( $Rank -eq $IVendor.Index )
                {
                    $IVendor.Name              = $This.Vendor.Name[$This.Vendor.Index[$I]]
                }

                $Rank                          = $Rank + $This.Vendor.List[$I]
            }

            Return $IVendor.Name
        }

        FENetwork ()
        {
            Get-ItemProperty "HKLM:\System\CurrentControlSet\Services\TCPIP\Parameters" | % { 

                $This.Path          = [FEModule]::New().Path
                $This.ComputerName  = $_.HostName
                $This.Domain        = $_.Domain
                $This.Vendor        = [FEVendorList]::New($This.Path)
            }

            $Cache                  = arp -a
            $ID                     = -1
            $List                   = @{ }
            $Adapter                = Get-NetAdapter
            $This.Interface         = @( )
            
            ForEach ( $I in 0..( $Cache.Count - 1 ) )
            {
                If ( $Cache[$I] -match "Interface:" )
                {
                    Write-Host "Detected [+] Interface"
                    $ID             ++
                    $List.Add( $ID , @( ) )
                }

                If ( $Cache[$I].Length -gt 0 )
                {
                    $List[$ID]      += $Cache[$I]
                }
            }
            
            If ( $List.Count -eq 1 )
            {
                $This.Interface                         = [FENetAdapter]::New( $List )
                
                $Adapter                                | ? IFIndex -eq $This.Interface.Index | % {

                    $This.Interface.Hostname            = $This.ComputerName
                    $This.Interface.Domain              = $This.Domain
                    $This.Interface.Alias               = $_.Name
                    $This.Interface.Description         = $_.InterfaceDescription
                    $This.Interface.MacAddress          = $_.MacAddress
                    $This.Interface.Vendor              = $This.GetVendor($_.MacAddress)
                }
            }

            If ( $List.Count -gt 1 )
            {
                ForEach ( $I in 0..( $List.Count - 1 ) )
                {
                    $This.Interface                    += [FENetAdapter]::New( $List[$I] )

                    $Adapter                            | ? IFIndex -eq $This.Interface[$I].Index | % { 

                        $This.Interface[$I].Hostname    = $This.ComputerName
                        $This.Interface[$I].Domain      = $This.Domain
                        $This.Interface[$I].Alias       = $_.Name
                        $This.Interface[$I].Description = $_.InterfaceDescription
                        $This.Interface[$I].MacAddress  = $_.MacAddress
                        $This.Interface[$I].Vendor      = $This.GetVendor($_.MacAddress)
                    }
                }
            }

            $This.HostRange     = @( )

            If ( $This.Interface.Count -eq 1 ) 
            {
                ForEach ( $X in 0..( $This.Interface.Table.Count - 1 ) )
                {
                    $Item = $This.Interface.Table[$X]

                    If ( $Item.MacAddress -notin $This.Hostrange.MacAddress )
                    {
                        If ( $Item.Hostname -ne "-" )
                        {
                            $This.HostRange += $Item
                        }
                    }
                }
            }

            Else
            {
                ForEach ( $I in 0..( $This.Interface.Count - 1 ) )
                {
                    ForEach ( $X in 0..( $This.Interface[$I].Table.Count - 1 ) )
                    {
                        $Item = $This.Interface[$I].Table[$X]

                        If ( $Item.MacAddress -notin $This.Hostrange.MacAddress )
                        {
                            If ( $Item.HostName -ne "-" )
                            {
                                $This.HostRange += $Item
                            }
                        }
                    }
                }
            }

            ForEach ( $I in 0..( $This.HostRange.Count - 1 ) )
            {
                $This.HostRange[$I].Vendor = $This.GetVendor($This.HostRange[$I].MacAddress)
            } 
        }

        [String] GetNetMask([Int32]$CIDR)
        {
            If ( $CIDR -notin 1..30 )
            {
                Throw "CIDR out of range"
            }
            
            $Switch                 = 0
            $Mask                   = 0..3
            $Slot                   = @{ 0 = 1..7 ; 1 = 8..15 ; 2 = 16..23 ; 3 = 24..30 }

            ForEach ( $I in 0..3 )
            {
                If ( $Switch -eq 1 ) 
                { 
                    $Mask[$I] = 0 
                }

                If ( $Switch -eq 0 )
                {
                    If ( $CIDR -in $Slot[$I] ) 
                    { 
                        $Mask[$I]   = @(0,128,192,224,240,248,252,254,255)[$CIDR % 8]
                        $Switch     = 1
                    } 
                
                    Else
                    { 
                        $Mask[$I]    = 255 
                    }
                }
            }
        
            Return $Mask[0..3] -join '.'
        }
    }
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____    ____    ____    ____    ____    ____    ___// 
    # Services _________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      

    Class FEService  
    {
        [Int32]             $Index
        [String]             $Name
        [Bool]              $Scope
        [Int32[]]            $Slot
        [String]        $StartMode
        [String]            $State
        [String]           $Status
        [String]      $DisplayName
        [String]         $PathName
        [String]      $Description

        FEService(){}

        Load([Int32]        $Index ,
            [String]         $Name ,
              [Bool]        $Scope ,
            [String]         $Slot ,
            [String]    $StartMode ,
            [String]        $State ,
            [String]       $Status ,
            [String]  $DisplayName ,
            [String]     $PathName ,
            [String]  $Description )
        {
            $This.Index            = $Index
            $This.Name             = $Name
            $This.Scope            = $Scope
            $This.Slot             = @( Invoke-Expression $Slot )
            $This.StartMode        = $StartMode
            $This.State            = $State
            $This.Status           = $Status
            $This.DisplayName      = $DisplayName
            $This.PathName         = $PathName
            $This.Description      = $Description
        }
    }

    Class FEQMark
    {
        [String] $PID
        
        FEQMark()
        {
            $This.PID              = ( Get-Service *_* -EA 0 | ? ServiceType -eq 224 | Select-Object -First 1 ).Name.Split('_')[-1]
        }
    }

    Class FEInfo
    {
        Hidden [Hashtable] $Hash = @{ 

            Edition              = ("10240,Threshold 1,Release To Manufacturing;10586,Threshold 2,November {1};14393,{0} 1,Anniversary {1};15063," + 
                                    "{0} 2,{2} {1};16299,{0} 3,Fall {2} {1};17134,{0} 4,April 2018 {1};17763,{0} 5,October 2018 {1};18362,19H1,Ma" + 
                                    "y 2019 {1};18363,19H2,November 2019 {1};19000,20H1,Unreleased") -f 'Redstone','Update','Creators' -Split ";"

            Chassis              = "N/A Desktop Mobile/Laptop Workstation Server Server Appliance Server Maximum" -Split " "

            SKU                  = ("Undefined,Ultimate {0},Home Basic {0},Home Premium {0},{3} {0},Home Basic N {0},Business {0},Standard {2} {0" + 
                                    "},Datacenter {2} {0},Small Business {2} {0},{3} {2} {0},Starter {0},Datacenter {2} Core {0},Standard {2} Cor" +
                                    "e {0},{3} {2} Core {0},{3} {2} IA64 {0},Business N {0},Web {2} {0},Cluster {2} {0},Home {2} {0},Storage Expr" + 
                                    "ess {2} {0},Storage Standard {2} {0},Storage Workgroup {2} {0},Storage {3} {2} {0},{2} For Small Business {0" + 
                                    "},Small Business {2} Premium {0},TBD,{1} {3},{1} Ultimate,Web {2} Core,-,-,-,{2} Foundation,{1} Home {2},-,{" + 
                                    "1} {2} Standard No Hyper-V Full,{1} {2} Datacenter No Hyper-V Full,{1} {2} {3} No Hyper-V Full,{1} {2} Datac" + 
                                    "enter No Hyper-V Core,{1} {2} Standard No Hyper-V Core,{1} {2} {3} No Hyper-V Core,Microsoft Hyper-V {2},Sto" + 
                                    "rage {2} Express Core,Storage {2} Standard Core,{2} Workgroup Core,Storage {2} {3} Core,Starter N,Profession" + 
                                    "al,Professional N,{1} Small Business {2} 2011 Essentials,-,-,-,-,-,-,-,-,-,-,-,-,Small Business {2} Premium " + 
                                    "Core,{1} {2} Hyper Core V,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,-,--,-,-,{1} Thin PC,-,{1} Embedded Industry,-,-" +
                                    ",-,-,-,-,-,{1} RT,-,-,Single Language N,{1} Home,-,{1} Professional with Media Center,{1} Mobile,-,-,-,-,-,-" + 
                                    ",-,-,-,-,-,-,-,{1} Embedded Handheld,-,-,-,-,{1} IoT Core") -f "Edition","Windows","Server","Enterprise" -Split ","
        }

        [Object]             $OS = (Get-CimInstance -ClassName Win32_OperatingSystem)
        [Object]             $CS = (Get-CimInstance -ClassName Win32_ComputerSystem)
        Hidden [Object]     $Env = ([PSCustomObject][Environment]::GetEnvironmentVariables().GetEnumerator() | Sort-Object Name)

        [String]        $Caption
        [Object]        $Version = $PSVersionTable.BuildVersion
        [String]          $Build
        [Int32]       $ReleaseID = (Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" ).ReleaseID
        [String]       $CodeName
        [String]           $Name

        [String]            $SKU
        [String]        $Chassis

        FEInfo()
        {
            $This.Build, $This.CodeName, $This.Name = $This.Hash.Edition[@{

                1507 = 0; 1511 = 1; 1607 = 2; 1703 = 3; 1709 = 4; 1803 = 5; 1809 = 6; 1903 = 7; 1909 = 8; 2004 = 9
            
            }[ $This.ReleaseID ] ].Split(",")

            $This.Caption        = $This.OS.Caption
            $This.SKU            = $This.Hash.SKU[$This.OS.OperatingSystemSKU]
            $This.Chassis        = $This.Hash.Chassis[$This.CS.PCSystemType]
        }
    }
        
    Class FETemplate
    {
        [String]            $Name  = "FightingEntropy/ViperBomb"
        [String]         $Version  = "2020.08.0"
        [String]         $Release  = "Development"
        [String]             $URL  = "https://github.com/secure-digits-plus-llc/FightingEntropy"
        [String]         $MadBomb  = "https://github.com/madbomb122/BlackViperScript"
        [String]      $BlackViper  = "http://www.blackviper.com"
        [String]            $Site  = "https://www.securedigitsplus.com"
        [String[]]     $Copyright  = ("Copyright (c) 2019 Zero Rights Reserved;Services Configuration by Charles 'Black Viper' Sparks;;The MIT Licens" + 
                                     "e (MIT) + an added Condition;;Copyright (c) 2017-2019 Madbomb122;;[Black Viper Service Script];Permission is her" + 
                                     "eby granted, free of charge, to any person obtaining a ;copy of this software and associated documentation files" + 
                                     " (the Software),;to deal in the Software without restriction, including w/o limitation;the rights to: use/copy/m" + 
                                     "odify/merge/publish/distribute/sublicense,;and/or sell copies of the Software, and to permit persons to whom the" +
                                     ";Software is furnished to do so, subject to the following conditions:;;The above copyright notice(s), this permi" +
                                     "ssion notice and ANY original;donation link shall be included in all copies or substantial portions of;the Softwa" +
                                     "re.;;The software is provided 'As Is', without warranty of any kind, express;or implied, including but not limite" +
                                     "d to warranties of merchantibility,;or fitness for a particular purpose and noninfringement. In no event;shall t" +
                                     "he authors or copyright holders be liable for any claim, damages;or other liability, whether in an action of con" +
                                     "tract, tort or otherwise,;arising from, out of or in connection with the software or the use or;other dealings i" +
                                     "n the software.;;In other words, these terms of service must be accepted in order to use,;and in no circumstance" +
                                     " may the author(s) be subjected to any liability;or damage resultant to its use.").Split(";")
        [String[]]         $About  = ("This utility provides an interface to load and customize;service configuration profiles, such as:;;    Default:" + 
                                      " Black Viper (Sparks v1.0);    Custom: If in proper format;    Backup: Created via this utility").Split(";")

        [String[]]          $Help  = (("[Basic];;_-atos___Accepts ToS;_-auto___Automates Process | Aborts upon user input/errors;;[Profile];;_-default_" +
                                     "_Standard;_-safe___Sparks/Safe;_-tweaked__Sparks/Tweaked;_-lcsc File.csv  Loads Custom Service Configuration, Fi" +
                                     "le.csv = Name of your backup/custom file;;[Template];;_-all___ Every windows services will change;_-min___ Just " + 
                                     "the services different from the default to safe/tweaked list;_-sxb___ Skips changes to all XBox Services;;[Updat" +
                                     "e];;_-usc___ Checks for Update to Script file before running;_-use___ Checks for Update to Service file before r" + 
                                     "unning;_-sic___ Skips Internet Check, if you can't ping GitHub.com for some reason;;[Logging];;_-log___ Makes a " +
                                     "log file named using default name Script.log;_-log File.log_Makes a log file named File.log;_-baf___ Log File of" + 
                                     " Services Configuration Before and After the script;;[Backup];;_-bscc___Backup Current Service Configuration, Cs" +
                                     "v File;_-bscr___Backup Current Service Configuration, Reg File;_-bscb___Backup Current Service Configuration, Cs" + 
                                     "v and Reg File;;[Display];;_-sas___ Show Already Set Services;_-snis___Show Not Installed Services;_-sss___ Show" +
                                     "Skipped Services;;[Miscellaneous];;_-dry___ Runs the Script and Shows what services will be changed;_-css___ Cha" +
                                     "nge State of Service;_-sds___ Stop Disabled Service;;[Experimental];;_-secp___Skips Edition Check by Setting Edi" +
                                     "tion as Pro;_-sech___Skips Edition Check by Setting Edition as Home;_-sbc___ Skips Build Check;;[Development];;_" + 
                                     "-devl___Makes a log file with various Diagnostic information, Nothing is Changed;_-diag___Shows diagnostic infor" + 
                                     "mation, Stops -auto;_-diagf__   Forced diagnostic information, Script does nothing else;;[Help];;_-help___Shows " + 
                                     "list of switches, then exits script.. alt -h;_-copy___Shows Copyright/License Information, then exits script" + 
                                     ";").Replace("_","    ")).Split(";")

        [Hashtable]          $Type = @{ 

            Names                  =  @( "H" , "P" | % { "10$_`:D" } ; "S" , "T" | % { "DT:$_" } ; "LT:S" ) | % { "$_+" , "$_-" }
            Titles                 = @( "Home" , "Pro" | % { "Windows 10 $_ | Default" } ; "Safe" , "Tweaked" | % { "Desktop | $_" } ; "Laptop | Safe" ) | % { "$_ Max" , "$_ Min" }
        }

        [Hashtable]        $Filter = @{ 

            Xbox                   = ("XblAuthManager XblGameSave XboxNetApiSvc XboxGipSvc xbgm" -Split " ")
            NetTCP                 = ("Msmq Pipe Tcp" -Split " " | % { "Net$_`Activator" })
            Skip                   = ("BcastDVRUserService DevicePickerUserSvc DevicesFlowUserSvc PimIndexMaintenanceSvc PrintWorkflowUserSvc Unistore" +
                                     "Svc UserDataSvc WpnUserService" -Split " " | % { "{0}_{1}" -f $_ , [FEQMark]::New().PID }) + ("AppXSVC BrokerInfra" + 
                                     "structure ClipSVC CoreMessagingRegistrar DcomLaunch EntAppSvc gpsvc LSM MpsSvc msiserver NgcCtnrSvc NgcSvc RpcEp" + 
                                     "tMapper RpcSs Schedule SecurityHealthService sppsvc StateRepository SystemEventsBroker tiledatamodelsvc WdNisSvc" +
                                     " WinDefend").Split(" ") | Sort-Object
        }

        [String[]]      $XamlNames = ("{0}0 {0}1 {0}2 {0}3 {0}4 {0}5 {0}6 {0}7 {0}8 {0}9 URL About Copyright MadBomb BlackViper Site Help TabControl Ca" + 
                                     "ption ReleaseID Version Chassis Search Select DataGrid {1}Build {1}Edition {1}Laptop {2}Active {2}Inactive {2}Ski" +
                                     "pped ServiceProfile MiscSimulate MiscXbox MiscChange MiscStopDisabled ScriptProfile DevelDiagErrors DevelLog Deve" + 
                                     "lConsole DevelDiagReport {3}ServiceSwitch {3}ServiceBrowse {3}ServiceFile {3}ScriptSwitch {3}ScriptBrowse {3}Scri" +
                                     "ptFile {4}{5}Switch {4}{5}Browse {4}{5}File {4}{6}Switch {4}{6}Browse {4}{6}File ConsoleOutput DiagnosticOutput S" + 
                                     "ervice Start Cancel Script" ) -f "Profile_ Bypass Display Logging Backup Registry Template".Split(" ") -Split " "

        Hidden [String]      $Xaml = @"
<Window 
                            xmlns = 'http://schemas.microsoft.com/winfx/2006/xaml/presentation'
                            xmlns:x = 'http://schemas.microsoft.com/winfx/2006/xaml'
                            Title = '[FightingEntropy] @ ViperBomb'
                            Height = '800'
                            Width = '800'
                            Topmost = 'True'
                        BorderBrush = 'Black'
                        ResizeMode = 'NoResize'
                HorizontalAlignment = 'Center'
            WindowStartupLocation = 'CenterScreen'>
    <Window.Resources>
        <Style x:Key         = 'SeparatorStyle1' 
            TargetType    = '{x:Type Separator}'>
            <Setter Property = 'SnapsToDevicePixels' 
                    Value    = 'True'/>
            <Setter Property = 'Margin' 
                    Value    = '0,0,0,0'/>
            <Setter Property = 'Template'>
                <Setter.Value>
                    <ControlTemplate TargetType     = '{x:Type Separator}'>
                        <Border Height              = '24' 
                                SnapsToDevicePixels = 'True' 
                                Background          = '#FF4D4D4D' 
                                BorderBrush         = 'Azure' 
                                BorderThickness     = '1,1,1,1' 
                                CornerRadius        = '5,5,5,5'/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType    = '{x:Type ToolTip}'>
            <Setter Property = 'Background' 
                    Value    = '#FFFFFFBF'/>
        </Style>
    </Window.Resources>
    <Window.Effect>
        <DropShadowEffect/>
    </Window.Effect>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height        = '20'/>
            <RowDefinition Height        = '*'/>
            <RowDefinition Height        = '60'/>
        </Grid.RowDefinitions>
        <Menu Grid.Row                   = '0'
                    IsMainMenu         = 'True'>
            <MenuItem     Header         = 'Configuration'>
                <MenuItem Name = 'Profile_0' Header = '0 - Windows 10 Home / Default Max'/>
                <MenuItem Name = 'Profile_1' Header = '1 - Windows 10 Home / Default Min'/>
                <MenuItem Name = 'Profile_2' Header = '2 - Windows 10 Pro / Default Max'/>
                <MenuItem Name = 'Profile_3' Header = '3 - Windows 10 Pro / Default Min'/>
                <MenuItem Name = 'Profile_4' Header = '4 - Desktop / Default Max'/>
                <MenuItem Name = 'Profile_5' Header = '5 - Desktop / Default Min'/>
                <MenuItem Name = 'Profile_6' Header = '6 - Desktop / Default Max'/>
                <MenuItem Name = 'Profile_7' Header = '7 - Desktop / Default Min'/>
                <MenuItem Name = 'Profile_8' Header = '8 - Laptop / Default Max'/>
                <MenuItem Name = 'Profile_9' Header = '9 - Laptop / Default Min'/>
            </MenuItem>
            <MenuItem     Header         = 'Info'>
                <MenuItem Name           = 'URL'
                        Header         = 'Resources'/>
                <MenuItem Name           = 'About'
                        Header         = 'About'/>
                <MenuItem Name           = 'Copyright'
                        Header         = 'Copyright'/>
                <MenuItem Name           = 'MadBomb'
                        Header         = 'MadBomb122'/>
                <MenuItem Name           = 'BlackViper'
                        Header         = 'BlackViper'/>
                <MenuItem Name           = 'Site'
                        Header         = 'Company Website'/>
                <MenuItem Name           = 'Help'
                        Header         = 'Help'/>
            </MenuItem>
        </Menu>
        <Grid Grid.Row                   = '1'>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width  = '*'/>
            </Grid.ColumnDefinitions>
            <TabControl BorderBrush      = 'Gainsboro' 
                        Grid.Row         = '1' 
                        Name             = 'TabControl'>
                <TabControl.Resources>
                    <Style TargetType    = 'TabItem'>
                        <Setter Property = 'Template'>
                            <Setter.Value>
                                <ControlTemplate TargetType                   = 'TabItem'>
                                    <Border Name                              = 'Border' 
                                            BorderThickness                   = '1,1,1,0' 
                                            BorderBrush                       = 'Gainsboro' 
                                            CornerRadius                      = '4,4,0,0' 
                                            Margin                            = '2,0'>
                                        <ContentPresenter x:Name              = 'ContentSite' 
                                                        VerticalAlignment   = 'Center' 
                                                        HorizontalAlignment = 'Center' 
                                                        ContentSource       = 'Header' 
                                                        Margin              = '10,2'/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property      = 'IsSelected' 
                                                Value         = 'True'>
                                            <Setter TargetName = 'Border' 
                                                    Property   = 'Background' 
                                                    Value      = 'LightSkyBlue'/>
                                        </Trigger>
                                        <Trigger Property      = 'IsSelected' 
                                                Value         = 'False'>
                                            <Setter TargetName = 'Border' 
                                                    Property   = 'Background' 
                                                    Value      = 'GhostWhite'/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </TabControl.Resources>
                <TabItem Header = 'Service Dialog'>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height = '60'/>
                            <RowDefinition Height = '32'/>
                            <RowDefinition Height =  '*'/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width = '0.45*'/>
                                <ColumnDefinition Width = '0.15*'/>
                                <ColumnDefinition Width = '0.25*'/>
                                <ColumnDefinition Width = '0.15*'/>
                            </Grid.ColumnDefinitions>
                            <GroupBox Grid.Column = "0" Header = "Operating System" Margin = "5">
                                <Label Name = "Caption"/>
                            </GroupBox>
                            <GroupBox Grid.Column = "1" Header = "Release ID" Margin = "5">
                                <Label Name = "ReleaseID"/>
                            </GroupBox>
                            <GroupBox Grid.Column = "2" Header = "Version" Margin = "5">
                                <Label Name = "Version"/>
                            </GroupBox>
                            <GroupBox Grid.Column = "3" Header = "Chassis" Margin = "5">
                                <Label Name = "Chassis"/>
                            </GroupBox>
                        </Grid>
                        <Grid Grid.Row            = '1'>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width = '0.66*'/>
                                <ColumnDefinition Width = '0.33*'/>
                                <ColumnDefinition Width = "1*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox  Grid.Column = '0' Margin ='5' Name = 'Search' TextWrapping      = 'Wrap'>Search</TextBox>
                            <ComboBox Grid.Column = '1' Margin ='5' Name = 'Select' VerticalAlignment = 'Center'>
                                <ComboBoxItem Content = 'Checked'/>
                                <ComboBoxItem Content = 'Display Name' IsSelected='True'/>
                                <ComboBoxItem Content = 'Name'/>
                                <ComboBoxItem Content = 'Current Setting'/>
                            </ComboBox>                            
                            <TextBlock Grid.Column = '2' 
                                            Margin         = '5' 
                                            TextAlignment  = 'Center'>Service State:
                                        <Run   Background     = '#66FF66' 
                                            Text           = 'Compliant'/> /
                                        <Run   Background     = '#FFFF66' 
                                            Text           = 'Unspecified'/> /
                                        <Run   Background     = '#FF6666' 
                                            Text           = 'Non Compliant'/>
                            </TextBlock>
                        </Grid>
                        <DataGrid Grid.Row                   = '2'
                                Grid.Column                = '0'
                                Name                       = 'DataGrid'
                                FrozenColumnCount          = '2' 
                                AutoGenerateColumns        = 'False' 
                                AlternationCount           = '2' 
                                HeadersVisibility          = 'Column' 
                                CanUserResizeRows          = 'False' 
                                CanUserAddRows             = 'False' 
                                IsTabStop                  = 'True' 
                                IsTextSearchEnabled        = 'True' 
                                SelectionMode              = 'Extended'>
                            <DataGrid.RowStyle>
                                <Style TargetType            = '{x:Type DataGridRow}'>
                                    <Style.Triggers>
                                        <Trigger Property    = 'AlternationIndex'
                                                Value       = '0'>
                                            <Setter Property = 'Background'
                                                    Value    = 'White'/>
                                        </Trigger>
                                        <Trigger Property    = 'AlternationIndex'
                                                Value       = '1'>
                                            <Setter Property = 'Background'
                                                    Value    = '#FFD8D8D8'/>
                                        </Trigger>
                                        <Trigger Property    = 'IsMouseOver'
                                                Value       = 'True'>
                                            <Setter Property = 'ToolTip'>
                                                <Setter.Value>
                                                    <TextBlock Text         = '{Binding Description}'
                                                            TextWrapping = 'Wrap'
                                                            Width        = '400'
                                                            Background   = '#FFFFFFBF'
                                                            Foreground   = 'Black'/>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property                = 'ToolTipService.ShowDuration'
                                                    Value                   = '360000000'/>
                                        </Trigger>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding          = '{Binding Scope}'
                                                        Value            = 'True'/>
                                                <Condition Binding          = '{Binding Matches}' 
                                                        Value            = 'False'/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property                = 'Background' 
                                                    Value                   = '#F08080'/>
                                        </MultiDataTrigger>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding          = '{Binding Scope}'
                                                        Value            = 'False'/>
                                                <Condition Binding          = '{Binding Matches}' 
                                                        Value            = 'False'/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property                = 'Background' 
                                                    Value                   = '#FFFFFF64'/>
                                        </MultiDataTrigger>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding          = '{Binding Scope}'
                                                        Value            = 'True'/>
                                                <Condition Binding          = '{Binding Matches}'
                                                        Value            = 'True'/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property                = 'Background'
                                                    Value                   = 'LightGreen'/>
                                        </MultiDataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header                  = 'Index' 
                                                    Width                   = '50'
                                                    Binding                 = '{Binding Index}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'Name'
                                                    Width                   = '150'
                                                    Binding                 = '{Binding Name}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'Scoped' 
                                                    Width                   = '75'
                                                    Binding                 = '{Binding Scope}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'Profile'
                                                    Width                   = '100'
                                                    Binding                 = '{Binding Slot}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'Status'
                                                    Width                   = '75'
                                                    Binding                 = '{Binding Status}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'StartType' 
                                                    Width                   = '75' 
                                                    Binding                 = '{Binding StartMode}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'DisplayName'
                                                    Width                   = '150'
                                                    Binding                 = '{Binding DisplayName}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'PathName'
                                                    Width                   = '150'
                                                    Binding                 = '{Binding PathName}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                                <DataGridTextColumn Header                  = 'Description'
                                                    Width                   = '150'
                                                    Binding                 = '{Binding Description}'
                                                    CanUserSort             = 'True'
                                                    IsReadOnly              = 'True'/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>
                <TabItem                            Header                  = 'Preferences'>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height = '1.25*'/>
                            <RowDefinition Height = '*'/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row = '0'>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width = '*'/>
                                <ColumnDefinition Width = '*'/>
                                <ColumnDefinition Width = '*'/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column = '2'>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height = '*'/>
                                    <RowDefinition Height = '*'/>
                                </Grid.RowDefinitions>
                                <GroupBox Grid.Row = '0' Header = 'Bypass / Checks [ Risky Options ]' Margin = '5'>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '*'/>
                                            <RowDefinition Height = '*'/>
                                            <RowDefinition Height = '*'/>
                                        </Grid.RowDefinitions>
                                        <CheckBox   Grid.Row = '1' Margin = '5' Name = 'BypassBuild' Content = "Skip Build/Version Check"/>
                                        <ComboBox   Grid.Row = '0' VerticalAlignment = 'Center' Height = '24' Name = 'BypassEdition'>
                                            <ComboBoxItem Content = 'Override Edition Check' IsSelected = 'True'/>
                                            <ComboBoxItem Content = 'Windows 10 Home'/>
                                            <ComboBoxItem Content = 'Windows 10 Pro'/>
                                        </ComboBox>
                                        <CheckBox   Grid.Row = '2' Margin = '5' Name = 'BypassLaptop' Content = 'Enable Laptop Tweaks'/>
                                    </Grid>
                                </GroupBox>
                                <GroupBox Grid.Row = '1' Header = 'Display' Margin = '5' >
                                    <Grid >
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                        </Grid.RowDefinitions>
                                        <CheckBox  Grid.Row = '0' Margin = '5' Name = 'DisplayActive'    Content = "Show Active Services"           />
                                        <CheckBox  Grid.Row = '1' Margin = '5' Name = 'DisplayInactive'  Content = "Show Inactive Services"         />
                                        <CheckBox  Grid.Row = '2' Margin = '5' Name = 'DisplaySkipped'   Content = "Show Skipped Services"          />
                                    </Grid>
                                </GroupBox>
                            </Grid>
                            <Grid Grid.Column = '0'>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height = '*'/>
                                    <RowDefinition Height = '2*'/>
                                </Grid.RowDefinitions>
                                <GroupBox Grid.Row = '0' Header = 'Service Configuration' Margin = '5'>
                                    <ComboBox  Grid.Row = '1' Name = 'ServiceProfile' Height ='24'>
                                        <ComboBoxItem Content = 'Black Viper (Sparks v1.0)' IsSelected = 'True'/>
                                        <ComboBoxItem Content = 'DevOPS (MC/SDP v1.0)' IsEnabled = 'False'/>
                                    </ComboBox>
                                </GroupBox>
                                <GroupBox Grid.Row = '1' Header = 'Miscellaneous' Margin = '5'>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                        </Grid.RowDefinitions>
                                        <CheckBox  Grid.Row = '0' Margin = '5' Name = 'MiscSimulate'     Content = "Simulate Changes [ Dry Run ]"   />
                                        <CheckBox  Grid.Row = '1' Margin = '5' Name = 'MiscXbox'         Content = "Skip All Xbox Services"         />
                                        <CheckBox  Grid.Row = '2' Margin = '5' Name = 'MiscChange'       Content = "Allow Change of Service State"  />
                                        <CheckBox  Grid.Row = '3' Margin = '5' Name = 'MiscStopDisabled' Content = "Stop Disabled Services"         />
                                    </Grid>
                                </GroupBox>
                            </Grid>
                            <Grid Grid.Column = '1'>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height = '*'/>
                                    <RowDefinition Height = '2*'/>
                                </Grid.RowDefinitions>
                                <GroupBox Grid.Row = '0' Header = 'User Interface' Margin = '5'>
                                    <ComboBox  Grid.Row = '1' Name = 'ScriptProfile' Height = '24' >
                                        <ComboBoxItem Content = 'DevOPS (MC/SDP v1.0)' IsSelected =  'True'/>
                                        <ComboBoxItem Content = 'MadBomb (MadBomb122 v1.0)' IsEnabled  = 'False' />
                                    </ComboBox>
                                </GroupBox>
                                <GroupBox Grid.Row='1' Header = 'Development' Margin='5'>
                                    <Grid >
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                            <RowDefinition Height = '30'/>
                                        </Grid.RowDefinitions>
                                        <CheckBox  Grid.Row = '0' Margin = '5' Name = 'DevelDiagErrors'  Content = "Diagnostic Output [ On Error ]" />
                                        <CheckBox  Grid.Row = '1' Margin = '5' Name = 'DevelLog'         Content = "Enable Development Logging"     />
                                        <CheckBox  Grid.Row = '2' Margin = '5' Name = 'DevelConsole'     Content = "Enable Console"                 />
                                        <CheckBox  Grid.Row = '3' Margin = '5' Name = 'DevelDiagReport'  Content = "Enable Diagnostic"              />
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row = '1'>
                            <Grid.RowDefinitions>
                                <RowDefinition Height = '*'/>
                                <RowDefinition Height = '*'/>
                            </Grid.RowDefinitions>
                            <GroupBox Grid.Row = '0' Header = 'Logging: Create logs for all changes made via this utility' Margin = '5'>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width = '75'/>
                                        <ColumnDefinition Width = '*'/>
                                        <ColumnDefinition Width = '6*'/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height = '*' />
                                        <RowDefinition Height = '*' />
                                    </Grid.RowDefinitions>
                                    <CheckBox Grid.Row = '0' Grid.Column = '0' Margin = '5' Name = 'LoggingServiceSwitch' Content   = 'Services' FlowDirection = 'RightToLeft'/>
                                    <Button   Grid.Row = '0' Grid.Column = '1' Margin = '5' Name = 'LoggingServiceBrowse' Content   = 'Browse'  />
                                    <TextBox  Grid.Row = '0' Grid.Column = '2' Margin = '5' Name = 'LoggingServiceFile'   IsEnabled = 'False'   />
                                    <CheckBox Grid.Row = '1' Grid.Column = '0' Margin = '5' Name = 'LoggingScriptSwitch'  Content   = 'Script'   FlowDirection = 'RightToLeft' />
                                    <Button   Grid.Row = '1' Grid.Column = '1' Margin = '5' Name = 'LoggingScriptBrowse'  Content   = 'Browse'  />
                                    <TextBox  Grid.Row = '1' Grid.Column = '2' Margin = '5' Name = 'LoggingScriptFile'    IsEnabled = 'False'   />
                                </Grid>
                            </GroupBox>
                            <GroupBox Grid.Row = '1' Header = 'Backup: Save your current Service Configuration' Margin = '5'>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width = '75'/>
                                        <ColumnDefinition Width = '*'/>
                                        <ColumnDefinition Width = '6*'/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height = '*' />
                                        <RowDefinition Height = '*' />
                                    </Grid.RowDefinitions>
                                    <CheckBox Grid.Row = '0' Grid.Column = '0' Margin = '5' Name = 'BackupRegistrySwitch' Content   = 'reg.*'   FlowDirection = 'RightToLeft'/>
                                    <Button   Grid.Row = '0' Grid.Column = '1' Margin = '5' Name = 'BackupRegistryBrowse' Content   = 'Browse'  />
                                    <TextBox  Grid.Row = '0' Grid.Column = '2' Margin = '5' Name = 'BackupRegistryFile'   IsEnabled = 'False'   />
                                    <CheckBox Grid.Row = '1' Grid.Column = '0' Margin = '5' Name = 'BackupTemplateSwitch' Content   = 'csv.*'  FlowDirection = 'RightToLeft' />
                                    <Button   Grid.Row = '1' Grid.Column = '1' Margin = '5' Name = 'BackupTemplateBrowse' Content   = 'Browse'  />
                                    <TextBox  Grid.Row = '1' Grid.Column = '2' Margin = '5' Name = 'BackupTemplateFile'   IsEnabled = 'False'   />
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem Header = 'Console'>
                    <Grid Background = '#FFE5E5E5'>
                        <ScrollViewer VerticalScrollBarVisibility = 'Visible'>
                            <TextBlock Name = 'ConsoleOutput' TextTrimming = 'CharacterEllipsis' Background = 'White' FontFamily = 'Lucida Console'/>
                        </ScrollViewer>
                    </Grid>
                </TabItem>
                <TabItem Header = 'Diagnostics'>
                    <Grid Background = '#FFE5E5E5'>
                        <ScrollViewer VerticalScrollBarVisibility = 'Visible'>
                            <TextBlock Name = 'DiagnosticOutput' TextTrimming = 'CharacterEllipsis' Background = 'White' FontFamily = 'Lucida Console'/>
                        </ScrollViewer>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>
        <Grid Grid.Row = '2'>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width = '2*'/>
                <ColumnDefinition Width = '*'/>
                <ColumnDefinition Width = '*'/>
                <ColumnDefinition Width = '2*'/>
            </Grid.ColumnDefinitions>
            <GroupBox Grid.Column = "0" Header = "Service Configuration" Margin = "5">
                <Label Name = "Service"/>
            </GroupBox>
            <Button Grid.Column = '1' Name =  'Start' Content = 'Start'  FontWeight = 'Bold' Margin = '10'/>
            <Button Grid.Column = '2' Name = 'Cancel' Content = 'Cancel' FontWeight = 'Bold' Margin = '10'/>
            <GroupBox Grid.Column = "3" Header = "Script/Module Version" Margin = "5">
                <Label Name = "Script" />
            </GroupBox>
        </Grid>
    </Grid>
</Window>
"@
        FETemplate() {}
    }

    Class FEConfig
    {
        Hidden [String[]] $Names       = (("AJRouter;ALG;AppHostSvc;AppIDSvc;Appinfo;AppMgmt;AppReadiness;AppVClient;aspnet_state;AssignedAccessManagerSvc;" + 
                                        "AudioEndpointBuilder;AudioSrv;AxInstSV;BcastDVRUserService_{0};BDESVC;BFE;BITS;BluetoothUserService_{0};Browser;B" +
                                        "TAGService;BthAvctpSvc;BthHFSrv;bthserv;c2wts;camsvc;CaptureService_{0};CDPSvc;CDPUserSvc_{0};CertPropSvc;COMSysA" + 
                                        "pp;CryptSvc;CscService;defragsvc;DeviceAssociationService;DeviceInstall;DevicePickerUserSvc_{0};DevQueryBroker;Dh" +
                                        "cp;diagnosticshub.standardcollector.service;diagsvc;DiagTrack;DmEnrollmentSvc;dmwappushsvc;Dnscache;DoSvc;dot3svc" +
                                        ";DPS;DsmSVC;DsRoleSvc;DsSvc;DusmSvc;EapHost;EFS;embeddedmode;EventLog;EventSystem;Fax;fdPHost;FDResPub;fhsvc;Font" +
                                        "Cache;FontCache3.0.0.0;FrameServer;ftpsvc;GraphicsPerfSvc;hidserv;hns;HomeGroupListener;HomeGroupProvider;HvHost;" +
                                        "icssvc;IKEEXT;InstallService;iphlpsvc;IpxlatCfgSvc;irmon;KeyIso;KtmRm;LanmanServer;LanmanWorkstation;lfsvc;Licens" + 
                                        "eManager;lltdsvc;lmhosts;LPDSVC;LxssManager;MapsBroker;MessagingService_{0};MSDTC;MSiSCSI;MsKeyboardFilter;MSMQ;M" +
                                        "SMQTriggers;NaturalAuthentication;NcaSVC;NcbService;NcdAutoSetup;Netlogon;Netman;NetMsmqActivator;NetPipeActivato" +
                                        "r;netprofm;NetSetupSvc;NetTcpActivator;NetTcpPortSharing;NlaSvc;nsi;OneSyncSvc_{0};p2pimsvc;p2psvc;PcaSvc;PeerDis" +
                                        "tSvc;PerfHost;PhoneSvc;pla;PlugPlay;PNRPAutoReg;PNRPsvc;PolicyAgent;Power;PrintNotify;PrintWorkflowUserSvc_{0};Pr" +
                                        "ofSvc;PushToInstall;QWAVE;RasAuto;RasMan;RemoteAccess;RemoteRegistry;RetailDemo;RmSvc;RpcLocator;SamSs;SCardSvr;S" +
                                        "cDeviceEnum;SCPolicySvc;SDRSVC;seclogon;SEMgrSvc;SENS;Sense;SensorDataService;SensorService;SensrSvc;SessionEnv;S" + 
                                        "grmBroker;SharedAccess;SharedRealitySvc;ShellHWDetection;shpamsvc;smphost;SmsRouter;SNMPTRAP;spectrum;Spooler;SSD" + 
                                        "PSRV;ssh-agent;SstpSvc;StiSvc;StorSvc;svsvc;swprv;SysMain;TabletInputService;TapiSrv;TermService;Themes;TieringEn" +
                                        "gineService;TimeBroker;TokenBroker;TrkWks;TrustedInstaller;tzautoupdate;UevAgentService;UI0Detect;UmRdpService;up" + 
                                        "nphost;UserManager;UsoSvc;VaultSvc;vds;vmcompute;vmicguestinterface;vmicheartbeat;vmickvpexchange;vmicrdv;vmicshu" +
                                        "tdown;vmictimesync;vmicvmsession;vmicvss;vmms;VSS;W32Time;W3LOGSVC;W3SVC;WaaSMedicSvc;WalletService;WarpJITSvc;WA" +
                                        "S;wbengine;WbioSrvc;Wcmsvc;wcncsvc;WdiServiceHost;WdiSystemHost;WebClient;Wecsvc;WEPHOSTSVC;wercplsupport;WerSvc;" + 
                                        "WFDSConSvc;WiaRpc;WinHttpAutoProxySvc;Winmgmt;WinRM;wisvc;WlanSvc;wlidsvc;wlpasvc;wmiApSrv;WMPNetworkSvc;WMSVC;wo" + 
                                        "rkfolderssvc;WpcMonSvc;WPDBusEnum;WpnService;WpnUserService_{0};wscsvc;WSearch;wuauserv;wudfsvc;WwanSvc;xbgm;XblA" + 
                                        "uthManager;XblGameSave;XboxGipSvc;XboxNetApiSvc") -f [FEQMark]::New().PID ).Split(";")

        Hidden [Int32[]] $Masks        = ("0;1;2;3;3;4;3;5;3;6;2;2;3;3;3;2;7;3;3;0;0;0;0;3;3;4;7;2;0;3;2;8;3;3;3;3;3;2;3;3;2;3;1;2;7;3;2;3;3;3;2;3;3;3;2;2" + 
                                        ";1;3;3;3;2;3;1;2;3;3;6;3;3;1;1;3;3;9;0;1;3;3;2;2;1;3;3;3;2;3;1;0;3;3;1;11;2;2;0;3;3;0;0;3;2;2;3;3;2;1;2;2;7;3;3;" + 
                                        "2;8;3;1;3;3;3;3;3;2;3;3;2;3;3;3;3;12;12;1;3;1;2;12;1;1;3;3;1;2;6;13;13;13;0;7;1;3;2;12;3;1;1;3;2;3;3;3;3;3;3;3;2" + 
                                        ";13;3;0;2;3;3;3;2;3;12;5;3;0;3;2;3;3;3;6;1;1;1;1;1;1;1;1;14;3;3;3;2;3;3;3;3;3;3;2;0;3;3;0;3;3;3;3;13;3;3;2;1;1;1" + 
                                        "5;3;3;3;1;3;1;1;3;2;2;7;7;3;3;1;3;1;1;3;1").Split(";")

        Hidden [String[]] $Values      = ("2,2,2,2,2,2,1,1,2,2;2,2,2,2,1,1,1,1,1,1;3,0,3,0,3,0,3,0,3,0;2,0,2,0,2,0,2,0,2,0;0,0,2,2,2,2,1,1,2,2;0,0,1,0,1,0" + 
                                        ",1,0,1,0;0,0,2,0,2,0,2,0,2,0;4,0,4,0,4,0,4,0,4,0;0,0,2,2,1,1,1,1,1,1;3,3,3,3,3,3,1,1,3,3;4,4,4,4,1,1,1,1,1,1;0,0" + 
                                        ",0,0,0,0,0,0,0,0;1,0,1,0,1,0,1,0,1,0;2,2,2,2,1,1,1,1,2,2;0,0,3,0,3,0,3,0,3,0;3,3,3,3,2,2,2,2,3,3").Split(";")

        Hidden [Hashtable] $Order
        Hidden [Array]     $Sort

        [Object] $Current              = ( Get-CimInstance Win32_Service | Sort-Object Name )
        [Object] $Profile

        FEConfig()
        {
            $This.Profile              = @( )
            $This.Order                = @{ }

            ForEach ( $I in 0..( $This.Names.Count - 1 ) )
            {
                $This.Order.Add($This.Names[$I],$I)
            }

            $This.Sort                 = $This.Values[$This.Masks]

            ForEach ( $I in 0..( $This.Current.Count - 1 ) )
            {
                $X                     = $This.Current[$I]
                $Scope                 = $X.Name -in $This.Names
                $Slot                  = $This.Sort[@(-1,$This.Order[$X.Name])[[Int]$Scope]]
                $This.Profile         += [FEService]::New()
                $This.Profile[$I].Load( $I, $X.Name, $Scope, $Slot, $X.StartMode, $X.State, $X.Status, $X.DisplayName, $X.PathName, $X.Description ) 
            }
        }
    }

    Class FEControl
    {        
        [String] $PassedArgs           = $Null
        [Int32]  $TermsOfService       = 0
        [Int32]  $DisplayActive        = 1
        [Int32]  $DisplayInactive      = 1
        [Int32]  $DisplaySkipped       = 1
        [Int32]  $MiscSimulate         = 0
        [Int32]  $MiscXbox             = 1
        [Int32]  $MiscChange           = 0
        [Int32]  $MiscStopDisabled     = 0
        [Int32]  $DevelDiagErrors      = 0
        [Int32]  $DevelLog             = 0
        [Int32]  $DevelConsole         = 0
        [Int32]  $DevelDiagReport      = 0
        [Int32]  $BypassBuild          = 0
        [Int32]  $BypassEdition        = 0
        [Int32]  $BypassLaptop         = 0
        [String] $LoggingServiceFile   = "Service.log"
        [String] $LoggingScriptFile    = "Script.log"
        [String] $BackupRegistryFile   = "Backup.reg"
        [String] $BackupTemplateFile   = "Backup.csv"
        [String] $ServiceConfig        = "Black Viper (Sparks v1.0)"
        [String] $ScriptConfig         = "DevOPS (MC/SDP v1.0)"

        FEControl()
        {

        }
    }

    Class FEViperBomb
    {
        [Object] $Template
        [Object] $Config
        [Object] $Control
        [Object] $Info

        ViperBomb()
        {
            $This.Template = [FETemplate]::New()
            $This.Config   = [FEConfig]::New()
            $This.Control  = [FEControl]::New()
            $This.Info     = [FEInfo]::New()
        }
    }

# Load Functions
                                                                                    #____ -- ____    ____ -- ____    ____ -- ____    ____ -- ____      
# ____                                                                            __//¯¯\\__//==\\__/----\__//==\\__/----\__//==\\__/----\__//¯¯\\___  
#//¯¯\\__________________________________________________________________________/¯¯¯    ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯¯ ¯¯ ¯¯¯\\ 
#\\__//¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯        ____    ____    ____    ____    ____    ____    ____    ___// 
    # __________________________________________________________________________________//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯\\__//¯¯¯  
    #¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯    ¯¯¯¯      
